function getStdTriangleCowperXyw(deg::Integer)
    # From https://www.math.unipd.it/~alvise/SETS_CUBATURE_TRIANGLE/cowper/set_cowper_standard.m
    if deg == 2
        return [5.00000000000000000000000000000000e-01 5.00000000000000000000000000000000e-01 1.66666666666666657414808128123695e-01
                5.00000000000000000000000000000000e-01 0.00000000000000000000000000000000e+00 1.66666666666666657414808128123695e-01
                0.00000000000000000000000000000000e+00 5.00000000000000000000000000000000e-01 1.66666666666666657414808128123695e-01]
    end
    if deg == 3
        return [3.33333333333333314829616256247391e-01 3.33333333333333314829616256247391e-01 -2.81250000000000000000000000000000e-01
                2.00000000000000011102230246251565e-01 2.00000000000000011102230246251565e-01 2.60416666666666685170383743752609e-01
                2.00000000000000011102230246251565e-01 5.99999999999999977795539507496869e-01 2.60416666666666685170383743752609e-01
                5.99999999999999977795539507496869e-01 2.00000000000000011102230246251565e-01 2.60416666666666685170383743752609e-01]
    end
    if deg == 4
        return [9.15762135097710067155318824916321e-02 9.15762135097710067155318824916321e-02 5.49758718276610602870846378209535e-02
                9.15762135097710067155318824916321e-02 8.16847572980457958813360619387822e-01 5.49758718276610602870846378209535e-02
                8.16847572980457958813360619387822e-01 9.15762135097710067155318824916321e-02 5.49758718276610602870846378209535e-02
                4.45948490915965001235576892213430e-01 4.45948490915965001235576892213430e-01 1.11690794839005624883299105931656e-01
                4.45948490915965001235576892213430e-01 1.08103018168069997528846215573139e-01 1.11690794839005624883299105931656e-01
                1.08103018168069997528846215573139e-01 4.45948490915965001235576892213430e-01 1.11690794839005624883299105931656e-01]
    end
    if deg == 5
        return [3.33333333333333314829616256247391e-01 3.33333333333333314829616256247391e-01 1.12500000000000002775557561562891e-01
                1.01286507323456329010546994595643e-01 1.01286507323456329010546994595643e-01 6.29695902724135836425745083033689e-02
                1.01286507323456329010546994595643e-01 7.97426985353087314223330395179801e-01 6.29695902724135836425745083033689e-02
                7.97426985353087314223330395179801e-01 1.01286507323456329010546994595643e-01 6.29695902724135836425745083033689e-02
                4.70142064105115053962435922585428e-01 4.70142064105115053962435922585428e-01 6.61970763942530820989063045090006e-02
                4.70142064105115053962435922585428e-01 5.97158717897698920751281548291445e-02 6.61970763942530820989063045090006e-02
                5.97158717897698920751281548291445e-02 4.70142064105115053962435922585428e-01 6.61970763942530820989063045090006e-02]
    end

    throw("No formula for degree $deg")
end

function integrateStdTriangle(xyw::AbstractMatrix{<:Number}, f::Function)
    n, m = size(xyw)
    @assert(m == 3)
    sum = 0.0
    for i = 1:n
        sum += f(xyw[i, 1], xyw[i, 2])
    end
    return sum
end

function getSimpleGridOnStdTriangle(n::Integer)
    h = 1.0 / n
    xs = Vector{Float32}()
    ys = Vector{Float32}()
    for iy = 0:(n - 1)
        y = (0.5 + iy) * h
        for ix = 0:(n - iy - 2)
            x = (0.5 + ix) * h
            push!(xs, x)
            push!(ys, y)
        end
    end
    m = lastindex(xs)
    xyw = zeros(m, 3)
    xyw[:,1] = xs
    xyw[:,2] = ys
    xyw[:,3] .= 0.5 / lastindex(xs)

    return xyw
end